<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Configurações básicas -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Corrida UDP</title>

    <!-- CSS do projeto -->
    <link href="/static/css/styles.css" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="/static/assets/favicon.ico" />

    <!-- Font Awesome (ícones) -->
    <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,300,400,600,700,800,900" rel="stylesheet" />

    <!-- Bootstrap -->
    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/sign-in/">

    <!-- Biblioteca Canvas Gauges (para os medidores analógicos) -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-gauges@2.1.7/gauge.min.js"></script>
</head>

<body id="body-dashboard">

<!-- Botão simples pra retornar ao histórico -->
<a class="btn btn-outline-success" href="/historico">Histórico</a>

<!-- Container principal dos gauges (indicadores visuais) -->
<div class="gauges">
    <div class="box1">
        <!-- Indicador de combustível -->
        <canvas id="fuelGauge"></canvas>
        <div class="box displayNone">Fuel: <span id="fuel" class="value">0</span></div>

        <!-- Indicador de RPM -->
        <canvas id="rpmGauge"></canvas>
        <div class="box displayNone">RPM: <span id="rpmValue" class="value">0</span></div>
    </div>
    
    <div class="box2">
        <!-- Indicador de velocidade -->
        <canvas id="speedGauge"></canvas>
        <div class="box displayNone">Velocidade: <span id="speedValue" class="value">0</span> km/h</div>

        <!-- Indicador de pressão do turbo (boost) -->
        <canvas id="boostGauge"></canvas>
        <div class="box displayNone">Boost: <span id="boostValue" class="value">0</span> bar</div>
    </div>
</div>

<!-- Outros dados da telemetria -->
<div class="outros-dados">
    <div class="info">
        <div class="box">Marcha: <span id="gear" class="value">0</span></div>
        <div class="box">Steer: <span id="steer" class="value">0</span>°</div>
        <div class="box">Best Lap: <span id="bestlap" class="value">0</span></div>
    </div>
    
    <!-- Barras de aceleração e freio -->
    <div class="bar-box">
        <div class="bar-label">Acelerador: <span id="accelValue">0</span>%</div>
        <div class="bar-container"><div id="accelBar" class="bar"></div></div>

        <div class="bar-label">Freio: <span id="brakeValue">0</span>%</div>
        <div class="bar-container"><div id="brakeBar" class="bar"></div></div>

        <hr>
        <div class="box">Corrida Status: <span id="corridastatus" class="value">True</span></div>
    </div>

    <div class="info">
        <div class="box">LapNumber: <span id="lapNumber" class="value">0</span></div>
        <div class="box">RacePosition: <span id="racePosition" class="value">0</span></div>
        <div class="box">Carro: <span id="carro" class="value">Mclaren F1</span></div>
    </div>
</div>

<!-- SCRIPT PRINCIPAL -->
<script>
    /* === CONFIGURAÇÃO DOS GAUGES === */
    
    // Gauge de RPM
    const rpmGauge = new RadialGauge({
        renderTo: 'rpmGauge',
        width: 300, height: 300,
        minValue: 0, maxValue: 9000,
        majorTicks: [0,1000,2000,3000,4000,5000,6000,7000,8000,9000],
        minorTicks: 5,
        value: 0,
        units: "RPM",
        colorPlate: "#111",
        colorMajorTicks: "#fff",
        colorMinorTicks: "#888",
        colorNumbers: "#0f0",
        colorNeedle: "rgba(255,0,0,1)",
        colorNeedleEnd: "rgba(255,0,0,1)",
        borders: false,
        needleType: "arrow",
        needleWidth: 2,
        animationDuration: 1500,
        animationRule: "linear",
        animation: true,
        highlights: [
            { from: 0, to: 4000, color: 'rgba(0,255,0,1)' },
            { from: 4000, to: 7000, color: 'rgba(255,255,0,1)' },
            { from: 7000, to: 9000, color: 'rgba(255,0,0,1)' }
        ]
    }).draw();

            // Atualização dinâmica do RPM (animação)
        let rpm = 0;
        setInterval(() => {
            rpm += Math.floor(Math.random() * 1000); // simula dados vindos do jogo
            if (rpm > 9000) rpm = 0;
            rpmGauge.value = rpm; // anima o needle automaticamente
        }, 1000); // atualiza a cada 1s

    // Gauge de Velocidade
    const speedGauge = new RadialGauge({
        renderTo: 'speedGauge',
        width: 300, height: 300,
        minValue: 0, maxValue: 400,
        majorTicks: [0,50,100,150,200,250,300,350,400],
        minorTicks: 5,
        value: 0,
        units: "km/h",
        colorPlate: "#111",
        colorMajorTicks: "#fff",
        colorMinorTicks: "#888",
        colorNumbers: "#0f0",
        colorNeedle: "rgba(0,255,255,1)",
        colorNeedleEnd: "rgba(0,255,255,1)",
        borders: false,
        needleType: "arrow",
        needleWidth: 2,
        animation: true,
        animationDuration: 1500,
        animationRule: "linear"
    }).draw();

        let speed = 0;
        setInterval(() => {
            speed += Math.floor(Math.random() * 1000); // simula dados vindos do jogo
            if (speed > 400) speed = 0;
            speedGauge.value = speed; // anima o needle automaticamente
        }, 1000); // atualiza a cada 1s

    // Gauge de Boost (pressão do turbo)
    const boostGauge = new RadialGauge({
        renderTo: 'boostGauge',
        width: 200, height: 200,
        minValue: -1, maxValue: 2,
        majorTicks: [-1,0,1,1.5,2],
        minorTicks: 5,
        value: 0,
        units: "bar",
        colorPlate: "#111",
        colorMajorTicks: "#fff",
        colorMinorTicks: "#888",
        colorNumbers: "#0f0",
        colorNeedle: "rgba(255,0,255,1)",
        colorNeedleEnd: "rgba(255,0,255,1)",
        borders: false,
        needleType: "arrow",
        needleWidth: 2,
        animationDuration: 1500,
        animation: true,
        animationRule: "linear"
    }).draw();

        let boost = 0;
        setInterval(() => {
            boost += Math.floor(Math.random() * 3); // simula dados vindos do jogo
            if (boost > 2) boost = 0;
            boostGauge.value = boost; // anima o needle automaticamente
        }, 1000); // atualiza a cada 1s

    // Gauge de Combustível
    const fuelGauge = new RadialGauge({
        renderTo: 'fuelGauge',
        width: 200, height: 200,
        minValue: 0, maxValue: 100,
        majorTicks: [0, 25, 50, 75, 100],
        minorTicks: 5,
        value: 0,
        units: "Fuel %",
        colorPlate: "#111",
        colorMajorTicks: "#fff",
        colorMinorTicks: "#888",
        colorNumbers: "#0f0",
        colorNeedle: "rgba(255,165,0,0.9)",
        colorNeedleEnd: "rgba(255,165,0,0.9)",
        borders: false,
        needleType: "arrow",
        needleWidth: 2,
        animation: true,
        animationDuration: 1500,
        animationRule: "linear",
        highlights: [
            { from: 0, to: 20, color: 'rgba(255,0,0,1)' },     
            { from: 20, to: 50, color: 'rgba(255,165,1)' },  
            { from: 50, to: 100, color: 'rgba(0,255,0,1)' }  
        ]
    }).draw();

        let fuel = 0;
        setInterval(() => {
            fuel += Math.floor(Math.random() * 100); // simula dados vindos do jogo
            if (fuel > 100) fuel = 0;
            fuelGauge.value = fuel; // anima o needle automaticamente
        }, 1000); // atualiza a cada 1s


    let gear = 1;
    let position = 1;
    let lap = 1;

    setInterval(() => {
        // Marcha sobe ou desce de 1 em 1, neutro = 0
        gear += Math.floor(Math.random() * 3) - 1; // -1,0,1
        if (gear < 0) gear = 0;
        if (gear > 6) gear = 6;
        document.getElementById('gear').innerText = gear === 0 ? 'N' : gear;

        // Posição sobe ou desce 1 no máximo
        position += Math.floor(Math.random() * 3) - 1;
        if (position < 1) position = 1;
        if (position > 12) position = 12;
        document.getElementById('racePosition').innerText = `${position}`;

        // Lap só aumenta
        if (Math.random() < 0.1) lap += 1; // 10% de chance de subir
        document.getElementById('lapNumber').innerText = lap;

        

    }, 1000);

    let steer = 0; // centro do volante
    const maxSteer = 200;

    setInterval(() => {
        // muda o ângulo suavemente, -5° a +5° por atualização
        steer += Math.floor(Math.random() * 11) - 5; // -5 a +5
        if (steer < -maxSteer) steer = -maxSteer;
        if (steer > maxSteer) steer = maxSteer;

        document.getElementById('steer').innerText = steer; // mostra no display
    }, 100); // atualiza a cada 0,1s (mais fluido)

    let accel = 0;
    let brake = 0;

    setInterval(() => {
    // Simula aceleração e freio entre 0% e 100%
    accel = Math.floor(Math.random() * 101);
    brake = Math.floor(Math.random() * 101);

    // Atualiza barras
    document.getElementById('accelBar').style.width = accel + '%';
    document.getElementById('accelValue').innerText = accel;

    document.getElementById('brakeBar').style.width = brake + '%';
    document.getElementById('brakeValue').innerText = brake;

}, 500); // atualiza a cada 0,5s

let bestLap = 0;

setInterval(() => {
    // Simula o tempo da melhor volta entre 60 e 120 segundos
    // Formata com 2 casas decimais
    const lapTime = (Math.random() * 60 + 60).toFixed(2);
    bestLap = lapTime;

    document.getElementById('bestlap').innerText = bestLap;
}, 2000); // atualiza a cada 2s

</script>

</body>
</html>
